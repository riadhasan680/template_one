{{ define "main" }}
  <!-- Banner + overlay bar (matches screenshot) -->
  <section class="w-full">
    <div class="relative w-full">
      {{ with .Params.banner }}
        <img src="{{ . }}" alt="{{ $.Title }}" class="w-full h-[300px] md:h-[420px] object-cover" />
      {{ else }}
        <img src="https://picsum.photos/seed/{{ .File.TranslationBaseName }}/1400/600" alt="{{ .Title }}" class="w-full h-[300px] md:h-[420px] object-cover" />
      {{ end }}
      <div class="absolute inset-0 bg-black/45"></div>
      <div class="absolute inset-x-0 bottom-0">
        <div class="max-w-7xl mx-auto px-4 md:px-6">
          <div class="flex items-center justify-between bg-white/10 backdrop-invert backdrop-opacity-10 text-white px-4 py-6">
            <div class="flex items-center gap-4">
              {{ $thumb := or .Params.thumb .Params.banner }}
              {{ with $thumb }}
                <img src="{{ . }}" alt="{{ $.Title }}" class="w-16 h-16 object-cover" />
              {{ end }}
              <div>
                <div class="font-[Oswald] uppercase text-[18px] md:text-[22px]">{{ .Title }}</div>
                {{ $platforms := or .Params.platforms (slice "Games" "PC" "PS4") }}
                <div class="text-xs text-gray-300">Released: {{ .Date.Format "January 2, 2006" }} — {{ delimit $platforms ", " }}</div>
              </div>
            </div>
            {{ $rating := or .Params.rating 7.8 }}
            {{ $label := "Good" }}
            {{ if lt $rating 7.5 }}{{ $label = "Fair" }}{{ end }}
            {{ if ge $rating 8.0 }}{{ $label = "Great" }}{{ end }}
            <div class="bg-[#fb4948] text-white px-4 py-2 text-center">
              <div class="text-2xl font-bold">{{ printf "%.1f" $rating }}</div>
              <div class="text-[12px] uppercase tracking-wide">{{ $label }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Tabs under banner -->
  <div class="w-full bg-white">
    <div class="max-w-7xl mx-auto px-4 md:px-6">
      {{ $tabs := slice (dict "id" "overview" "label" .Title) (dict "id" "previews" "label" "Previews") (dict "id" "news" "label" "News") (dict "id" "images" "label" "Images") (dict "id" "videos" "label" "Videos") (dict "id" "forums" "label" "Forums") }}
      <nav class="grid grid-cols-3 sm:grid-cols-6 w-full text-xs md:text-sm border-b">
        {{ range $index, $t := $tabs }}
          {{ $isActive := eq $index 0 }}
          <button class="tab-link py-3 text-center font-medium uppercase font-[Oswald] {{ if $isActive }}text-[#38b6bb] border-b border-[#38b6bb]{{ else }}text-gray-600 hover:text-[#38b6bb]{{ end }}" data-tab="{{ $t.id }}">{{ $t.label }}</button>
        {{ end }}
      </nav>
    </div>
  </div>

  <!-- Tab Panels -->
  <section class="w-full bg-white">
    <div class="max-w-7xl mx-auto px-4 md:px-6 py-8">
      <div id="overview" class="tab-panel block grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Left: Latest News list -->
        <div class="lg:col-span-2">
          <h2 class="text-[18px] md:text-[20px] font-[Oswald] uppercase tracking-wide text-[#3e6a91] mb-4">Latest News</h2>
          {{ $all := (where .Site.RegularPages "Section" "latest-games") }}
          {{ $others := (where $all "File.TranslationBaseName" "ne" .File.TranslationBaseName) }}
          {{ range first 6 $others }}
          <a href="{{ .RelPermalink }}" class="flex gap-4 py-4 border-b group">
            {{ with .Params.banner }}
           <div class="w-[250px]">
              <img src="{{ . }}" alt="{{ $.Title }}" class="w-[250px] h-[135px] object-cover" />
           </div>
            {{ else }}
           <div class="w-[250px]">
             <img src="https://picsum.photos/seed/{{ .File.TranslationBaseName }}/280/180" alt="{{ .Title }}" class="w-[250px] h-[135px] object-cover" />
           </div>
            {{ end }}
            <div class="w-full">
              <div class="text-sm md:text-base font-semibold text-black hover:text-[#fe4a49]">{{ .Title }}</div>
             
              {{ $raw := .Content | plainify }}
              {{ $parts := split $raw " " }}
              <p class="text-xs md:text-sm text-gray-600">{{ delimit ( first 28 $parts ) " " }}…</p>
               <div class="text-xs font-light text-[#999] opacity-88  mb-1 flex items-center gap-3  mt-1">
  <p class="hover:underline">{{ with .Params.author }}{{ . }}{{ else }}GhostPool{{ end }}</p>
  <p class="hover:underline">{{ .Date.Format "January 2, 2006" }}</p>
  <p class="hover:underline">No Comments</p>
</div>

            </div>
          </a>
          {{ end }}
        </div>

        <!-- Right: Sidebar info -->
        <aside class="lg:col-span-1 space-y-6">
          <!-- Top image -->
          {{ with .Params.banner }}
          <img src="{{ . }}" alt="{{ $.Title }}" class="w-full h-[180px] object-cover" />
          {{ end }}

          <!-- About card (blue) -->
          <div class="bg-[#1f3c53] text-white p-5">
            <div class="font-[Oswald] uppercase text-[16px] mb-2">{{ .Title }}</div>
            <div class="text-xs text-gray-300">Released: {{ .Date.Format "January 2, 2006" }}</div>
            {{ with .Params.summary }}
            <p class="mt-3 text-[13px] leading-6">{{ . }}</p>
            {{ else }}
            {{ $rawsum := .Content | plainify }}
            <p class="mt-3 text-[13px] leading-6">{{ delimit ( first 50 (split $rawsum " ") ) " " }}…</p>
            {{ end }}
          </div>

          <!-- Score box -->
          <div class="bg-white border p-4">
            <div class="flex items-center gap-4">
              <div class="bg-[#fb8c00] text-white w-14 h-14 flex items-center justify-center flex-col">
                <div class="text-lg font-bold">{{ printf "%.1f" (or .Params.rating 7.8) }}</div>
                <div class="text-[10px] uppercase">{{ or .Params.rating_label "Good" }}</div>
              </div>
              <div class="text-xs text-gray-600">
                <div>Average user rating</div>
                <div>{{ with .Params.votes }}{{ . }}{{ else }}78{{ end }} votes</div>
              </div>
            </div>
          </div>

          <!-- Have your say CTA -->
          <div class="bg-white border p-4">
            <div class="text-xs text-gray-700 mb-2">Have your say</div>
            <button class="w-full bg-[#2ecc71] text-white py-2">Vote Up</button>
            <button class="w-full bg-[#fb4948] text-white py-2 mt-2">Vote Down</button>
          </div>

          <!-- Images grid -->
          <div class="bg-white border p-4">
            <div class="font-[Oswald] uppercase text-[14px] mb-3">Images</div>
            {{ $images := or .Params.images (slice) }}
            <div class="grid grid-cols-3 gap-2">
              {{ if gt (len $images) 0 }}
                {{ range first 6 $images }}
                  <img src="{{ . }}" alt="{{ $.Title }} image" class="w-full h-20 object-cover" />
                {{ end }}
              {{ else }}
                {{ range seq 6 }}
                  <img src="https://picsum.photos/seed/{{ $.File.TranslationBaseName }}-{{ . }}/200/200" alt="{{ $.Title }} image" class="w-full h-20 object-cover" />
                {{ end }}
              {{ end }}
            </div>
          </div>

          <!-- Videos -->
          <div class="bg-white border p-4">
            <div class="font-[Oswald] uppercase text-[14px] mb-3">Videos</div>
            {{ $video := or .Params.video "https://www.youtube.com/embed/aqz-KE-bpKQ" }}
            {{ $isYT := or (in $video "youtube.com") (or (in $video "youtu.be") (in $video "embed")) }}
            <div class="w-full h-[160px] bg-black">
              {{ if $isYT }}
                <iframe class="w-full h-full" src="{{ $video }}" title="{{ .Title }}" frameborder="0"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                  allowfullscreen></iframe>
              {{ else }}
                <video controls playsinline preload="metadata" class="w-full h-full object-cover">
                  <source src="{{ $video }}" type="video/mp4" />
                </video>
              {{ end }}
            </div>
          </div>
        </aside>
      </div>

      <!-- Previews -->
      <div id="previews" class="tab-panel hidden">
          <h2 class="text-[18px] md:text-[20px] font-[Oswald] uppercase tracking-wide text-[#3e6a91]  mb-4">Previews</h2>
        {{ $previews := slice (dict "title" "Dead Rising 5 Preview" "img" (or .Params.banner (printf "https://picsum.photos/seed/%s/600/400" .File.TranslationBaseName)) "date" "May 20, 2017" "author" "GhostPool" "excerpt" "Phosfluorescently enhance synergistic sources without intuitive supply chains.") (dict "title" "Hands-on Impressions" "img" (printf "https://picsum.photos/seed/%s-pre1/600/400" .File.TranslationBaseName) "date" "Apr 12, 2017" "author" "Red" "excerpt" "Collaboratively create value across platforms with scalable workflows.") }}
        <div class="space-y-4">
          {{ range $previews }}
          <div class="grid grid-cols-[140px_1fr] gap-4 border-b pb-4">
            <img src="{{ .img }}" alt="{{ .title }}" class="w-[140px] h-[90px] object-cover" />
            <div>
              <div class="text-sm md:text-base font-semibold text-black">{{ .title }}</div>
              <div class="text-xs text-gray-500 mb-1">{{ .date }} — {{ .author }}</div>
              <p class="text-xs md:text-sm text-gray-600">{{ .excerpt }}</p>
            </div>
          </div>
          {{ end }}
        </div>
      </div>

      <!-- News -->
      <div id="news" class="tab-panel hidden">
          <h2 class="text-[18px] md:text-[20px] font-[Oswald] uppercase tracking-wide text-[#3e6a91]  mb-4">News</h2>
        {{ $news := slice (dict "title" "Xbox One Backwards Compatibility Games" "img" (printf "https://picsum.photos/seed/%s-news1/600/400" .File.TranslationBaseName) "date" "April 20, 2017" "author" "GhostPool" "excerpt" "Energetically maximize ubiquitous products before resource-leveling systems.") (dict "title" "Bundles Announced" "img" (printf "https://picsum.photos/seed/%s-news2/600/400" .File.TranslationBaseName) "date" "March 20, 2017" "author" "Red" "excerpt" "Monotonectally restore integrated niches.") }}
        <div class="space-y-4">
          {{ range $news }}
          <div class="grid grid-cols-[250px_1fr] gap-4 border-b pb-4">
            <img src="{{ .img }}" alt="{{ .title }}" class="w-[250px] h-[135px] object-cover" />
            <div>
              <div class="text-sm md:text-base font-semibold text-black hover:underline">{{ .title }}</div>
              <div class="text-xs text-gray-500 mb-1">{{ with .author }}{{ . }}{{ else }}GhostPool{{ end }} — {{ .date }} — No Comments</div>
              <p class="text-xs md:text-sm text-gray-600">{{ .excerpt }}</p>
            </div>
          </div>
          {{ end }}
        </div>
      </div>

      <!-- Images -->
      <div id="images" class="tab-panel hidden">
          <h2 class="text-[18px] md:text-[20px] font-[Oswald] uppercase tracking-wide text-[#3e6a91]  mb-4">Images</h2>
        {{ $images := or .Params.images (slice) }}
        <div class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-2">
          {{ if gt (len $images) 0 }}
            {{ range first 10 $images }}
              <img src="{{ . }}" alt="{{ $.Title }} image" class="w-full h-24 object-cover" />
            {{ end }}
          {{ else }}
            {{ range seq 10 }}
              <img src="https://picsum.photos/seed/{{ $.File.TranslationBaseName }}-{{ . }}/200/200" alt="{{ $.Title }} image" class="w-full h-24 object-cover" />
            {{ end }}
          {{ end }}
        </div>
      </div>

      <!-- Videos -->
      <div id="videos" class="tab-panel hidden">
         <h2 class="text-[18px] md:text-[20px] font-[Oswald] uppercase tracking-wide text-[#3e6a91]  mb-4">Videos</h2>
        {{ $video := or .Params.video "https://www.youtube.com/embed/aqz-KE-bpKQ" }}
        {{ $isYT := or (in $video "youtube.com") (or (in $video "youtu.be") (in $video "embed")) }}
        <div class="w-full h-[220px] md:h-[360px] bg-black">
          {{ if $isYT }}
            <iframe class="w-full h-full" src="{{ $video }}" title="{{ .Title }}" frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              allowfullscreen></iframe>
          {{ else }}
            <video controls playsinline preload="metadata" class="w-full h-full object-cover">
              <source src="{{ $video }}" type="video/mp4" />
            </video>
          {{ end }}
        </div>
      </div>

      <!-- Forums -->
      <div id="forums" class="tab-panel hidden">
        <h3 class="text-lg font-[Oswald] uppercase tracking-wide text-[#3e6a91] mb-4">Forums</h3>
        <div class="border">
          <div class="grid grid-cols-4 bg-black text-white text-sm">
            <div class="px-4 py-3">Topic</div>
            <div class="px-4 py-3 text-center">Voices</div>
            <div class="px-4 py-3 text-center">Posts</div>
            <div class="px-4 py-3 text-center">Last Post</div>
          </div>
          {{ $topics := slice (dict "title" "Bananas" "author" "Red" "voices" 1 "posts" 1 "last" "2 years, 9 months ago" "last_by" "Red") (dict "title" "hehe" "author" "Red" "voices" 1 "posts" 4 "last" "5 years ago" "last_by" "Red") (dict "title" "Professionally engineer frictionless value rather than" "author" "GhostPool" "voices" 2 "posts" 9 "last" "6 years, 1 month ago" "last_by" "Red") (dict "title" "new topic test" "author" "Red" "voices" 1 "posts" 4 "last" "7 years, 8 months ago" "last" "7 years, 8 months ago" "last_by" "Red") (dict "title" "Uniquely e-enable visionary niches" "author" "GhostPool" "voices" 1 "posts" 1 "last" "8 years, 6 months ago" "last_by" "GhostPool") }}
          {{ range $topics }}
          <div class="grid grid-cols-4 text-sm border-t">
            <div class="px-4 py-3 text-[#fb4948]">{{ .title }}<div class="text-xs text-gray-600">Started by: {{ .author }}</div></div>
            <div class="px-4 py-3 text-center">{{ .voices }}</div>
            <div class="px-4 py-3 text-center">{{ .posts }}</div>
            <div class="px-4 py-3 text-center"><div class="text-[#fb4948]">{{ .last }}</div><div class="text-xs text-[#fb4948]">{{ .last_by }}</div></div>
          </div>
          {{ end }}
        </div>
        <div class="mt-4 text-xs bg-yellow-50 border px-4 py-3">You must be logged in to create new topics.</div>
        <div class="mt-4 border p-4 grid gap-3 max-w-md">
          <label class="text-sm">Username:
            <input type="text" class="mt-1 w-full border px-3 py-2" placeholder="Enter username" />
          </label>
          <label class="text-sm">Password:
            <input type="password" class="mt-1 w-full border px-3 py-2" placeholder="Enter password" />
          </label>
          <label class="inline-flex items-center gap-2 text-sm"><input type="checkbox" /> Keep me signed in</label>
          <a href="#" class="text-[#3e6a91] text-sm">Login with your Social ID</a>
        </div>
      </div>
    </div>
  </section>
  <script>
  (function(){
    const links = document.querySelectorAll('.tab-link');
    const panels = document.querySelectorAll('.tab-panel');
    function activate(id){
      panels.forEach(p=>p.classList.toggle('hidden', p.id!==id));
      panels.forEach(p=>p.classList.toggle('block', p.id===id));
      links.forEach(l=>{
        const a = l.getAttribute('data-tab')===id;
        if (a) {
          l.classList.add('text-[#38b6bb]','border-b','border-[#38b6bb]');
          l.classList.remove('text-gray-600','border-b-2');
        } else {
          l.classList.add('text-gray-600');
          l.classList.remove('text-[#38b6bb]','border-b','border-[#38b6bb]','border-b-2');
        }
      });
    }
    links.forEach(l=>l.addEventListener('click', function(e){ e.preventDefault(); activate(this.getAttribute('data-tab')); }));
    activate('overview');
  })();
  </script>
{{ end }}